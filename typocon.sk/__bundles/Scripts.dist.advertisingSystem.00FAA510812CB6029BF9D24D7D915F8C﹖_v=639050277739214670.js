(()=>{"use strict";class n{constructor(n,t,i,r){this.id=r;this.name=n;this.width=t;this.height=i}}class r{constructor(n){this.Formats=[];this.initFormatsByKey(n)}initFormatsByKey(t){this.Formats=[];"UnboundedSheet"==t||"Sticker"==t||"SpecialMaterial"==t?(this.Formats.push(new n("MaxSDP",308,440,13)),this.Formats.push(new n("A3",297,420,22)),this.Formats.push(new n("A4",210,297,23)),this.Formats.push(new n("A5",148,210,24)),this.Formats.push(new n("A6",105,148,25)),this.Formats.push(new n("A7",74,105,26)),this.Formats.push(new n("F420x100",420,100,28)),this.Formats.push(new n("F90x50",90,50,29)),this.Formats.push(new n("F85x55",85,55,30)),this.Formats.push(new n("DL",210,100,27))):"LargeDigitalPrint"==t?(this.Formats.push(new n("MaxLDP",2030,3200,14)),this.Formats.push(new n("A0",841,1189,19)),this.Formats.push(new n("A1",594,841,20)),this.Formats.push(new n("A2",420,594,21)),this.Formats.push(new n("A3",297,420,22)),this.Formats.push(new n("A4",210,297,23)),this.Formats.push(new n("B0",1e3,1414,15)),this.Formats.push(new n("B1",707,1e3,16)),this.Formats.push(new n("B2",500,707,17)),this.Formats.push(new n("B3",353,500,18)),this.Formats.push(new n("Custom",210,100,31)),this.Formats.push(new n("E800x2000",800,2e3,35)),this.Formats.push(new n("E850x2000",850,2e3,36)),this.Formats.push(new n("E1000x2000",1e3,2e3,37)),this.Formats.push(new n("E1200x2000",1200,2e3,38)),this.Formats.push(new n("E1500x2000",1500,2e3,39)),this.Formats.push(new n("E2000x2000",2e3,2e3,40)),this.Formats.push(new n("D850x2000",850,2e3,41)),this.Formats.push(new n("D1000x2000",1e3,2e3,42)),this.Formats.push(new n("OB100x100",100,100,44)),this.Formats.push(new n("OB100x150",100,150,45)),this.Formats.push(new n("OB200x200",200,200,46)),this.Formats.push(new n("OB200x300",200,300,47)),this.Formats.push(new n("OB300x400",300,400,48)),this.Formats.push(new n("OB500x700",500,700,49)),this.Formats.push(new n("OB700x1000",700,1e3,50)),this.Formats.push(new n("OB3000x3000",3e3,3e3,51)),this.Formats.push(new n("OB1900x2900",1900,2900,52)),this.Formats.push(new n("OB2000x3000",2e3,3e3,53)),this.Formats.push(new n("OB1000x2000",1e3,2e3,54))):"BoundedSheet"==t&&(this.Formats.push(new n("A6P",105,148,9)),this.Formats.push(new n("A6L",148,105,10)),this.Formats.push(new n("A5P",148,210,7)),this.Formats.push(new n("A5L",210,148,8)),this.Formats.push(new n("A4P",210,297,5)),this.Formats.push(new n("A4L",297,210,6)),this.Formats.push(new n("A3P",297,420,3)),this.Formats.push(new n("A3L",420,297,4)),this.Formats.push(new n("MaxP",308,440,1)),this.Formats.push(new n("MaxL",440,308,2)),this.Formats.push(new n("DLP",100,210,27)),this.Formats.push(new n("DLL",210,100,27)),this.Formats.push(new n("DLL",210,100,27)),this.Formats.push(new n("C150x200",150,200,55)),this.Formats.push(new n("C300x125",300,125,56)),this.Formats.push(new n("C150x420",150,420,57)),this.Formats.push(new n("C210x297",210,297,58)),this.Formats.push(new n("C240x420",240,420,59)),this.Formats.push(new n("C280x420",280,420,60)),this.Formats.push(new n("C297x420",297,420,61)),this.Formats.push(new n("C308x220",308,220,62)),this.Formats.push(new n("C380x520",380,260,63)),this.Formats.push(new n("C198x148",198,148,64)))}getFormatByValue(n){for(var t=0,i=this.Formats.length;t<i;t++)if(this.Formats[t].name==n)return this.Formats[t]}getFormatById(n){for(var t=0,i=this.Formats.length;t<i;t++)if(this.Formats[t].id==n)return this.Formats[t]}}class u{constructor(){this.reset()}reset(){this.defaultProductId=0;this.productTemplateId="";this.sku="";this.isDefault=!1;this.templateKey="NoProduct";this.name="";this.sortKey=null;this.orderId=null;this.comments="";this.extraWork="";this.itemCount=0;this.formatKey="31";this.width=0;this.height=0;this.pageCount=0;this.sheetCountOrAreaM2=0;this.materialKey="NoMaterial";this.grammageOrThickness=0;this.chromaFrontEnum=1;this.chromaBackEnum=1;this.whiteFrontEnum=1;this.whiteBackEnum=1;this.lackerMatteFrontEnum=1;this.lackerMatteBackEnum=1;this.lackerGlossFrontEnum=1;this.lackerGlossBackEnum=1;this.uvRedFrontEnum=1;this.uvRedBackEnum=1;this.laminoFrontEnum=1;this.laminoBackEnum=1;this.whiteLdpEnum=1;this.lackerLdpEnum=1;this.encapsulationOrBleed=!1;this.dieCut=!1;this.kissCut=!1;this.edgeReinforcement=!1;this.tunnel=!1;this.eyelets=!1;this.canvasEdge=1;this.screws=1;this.roundedCorners=!1;this.pesonalizationEnum=1;this.foldKey="NoFold";this.coldStampFrontEnum="NoStamp";this.coldStampBackEnum="NoStamp";this.coverPageCount=0;this.coverSheetCountOrAreaM2=0;this.coverMaterialKey="NoMaterial";this.coverGrammageOrThickness=-1;this.coverChromaFrontEnum=1;this.coverChromaBackEnum=1;this.coverLaminoFrontEnum=1;this.coverLaminoBackEnum=1;this.coverEncapsulation=!1;this.noBindOrDuplex=!1;this.bindingKey="NoBind";this.bindingComments=null;this.unibindBackKey="NoBack";this.unibindBackColorEnum=1;this.coilSpiralKey="NoSpiral";this.coilSpiralColorEnum=1;this.coilFoilKey="NoFoil";this.coilFoilColorEnum=1;this.coilCartonKey="";this.coilCartonColorEnum=1;this.frameEnum=1;this.stateEnum=1;this.chromaFrontConst=1;this.chromaFrontCoef=1;this.chromaBackConst=1;this.chromaBackCoef=1;this.discountChromaPC=0;this.discountMinSheetsorM2=1e3;this.isNew=!1;this.promoText="";this.taxPc=23;this.priceBase=0;this.price=0;this.priceExtra=0;this.isPriceDraft=!1;this.isMaterialTypeDiscount=!1;this.hasFixedPrice=!1;this.isWhite=!1;this.discount=0;this.productNote="";this.optionId=null;this.printDataType=0;this.printDataLink="";this.printDataInfo=""}}class t{static start(){""==window.location.hash?t.navigate("orders"):$(window).trigger("hashchange")}static changeRoute(n){abp.event.trigger("changeRoute",n)}static navigate(n,t){var i=null!=t?this.createUrlParameters(t):"";window.location.hash="#"+n+i}static createUrlParameters(n){var t="";return Object.keys(n).forEach(function(i,r){0==r?t="?":r>=1&&(t+="&");t+=i+"="+n[i]}),t}static getProductRouteName(n){var t="";switch(n){case"UnboundedSheet":case"Sticker":case"SpecialMaterial":t="SmallDigitalPrint";break;case"BoundedSheet":t="BoundedSheet";break;case"RollMaterial":case"SheetMaterial":case"PlateMaterial":t="LargeDigitalPrint";break;case"AdvertisingSystem":case"WallSticker":t="AdvertisingSystem";break;default:t="GeneralProduct"}return t}static isAdmin(){return""!=window.location.hash}}class f{onStart(){}onLeave(){}onEnter(){}onDestroy(){}setTitle(){}}class e extends f{constructor(n,t){super();this.min=1;this.max=1e5;this.minDimensions=[1,1];this.maxDimensions=[1e5,1e5];this.stepDimension=1;this.calculatePriceDelay=400;this.loadFilesFromFolderCallback=()=>{var n;this.loadFilesFromFolder();"function"==typeof smartsupp&&(null===(n=top.document.getElementById("smartsupp-widget-container"))||void 0===n||n.style.setProperty("display","block","important"))};this.pageSelector=null!=t?t:"body";this.ActualFormats=new r(n);this.Product=new u}onStart(){console.log("init file upload");this.initFileUpload();this.initUserEdit();this.initOrderDetail();this.setTitle();this.changeHeightOfBackstage()}onEnter(){$(this.pageSelector+" .selectpicker").selectpicker();LayoutCheckboxVisibilityToggle.init();this.initFormEvents()}onDestroy(){$(this.pageSelector+" .selectpicker").selectpicker("destroy");$(this.pageSelector+" .c-toggle-hide").off("change");$(".update-product").off("click");$(this.pageSelector+" .calculate").off("change");$(this.pageSelector+" #add-to-basket").off("click");$(this.pageSelector+" #add-to-order").off("click");console.log("fileupload destroy");$(this.pageSelector+" .fileupload").off("fileuploaddestroy");$(this.pageSelector+" .fileupload").fileupload("destroy");$(this.pageSelector+" #EditUserButton").off("click");$(this.pageSelector+" #OrderDetailButton").off("click");$(this.pageSelector).off("click",".create-zip");$(this.pageSelector+" .remove-coupon").off("click");$("body").off("click",".link-open-design");window.removeEventListener("StudioFinished",this.loadFilesFromFolderCallback,!1);this.Product.reset()}onLeave(){}changeHeightOfBackstage(){var n=$(this.pageSelector+" .right-side").outerHeight();this.P$(".backstage-top").css("min-height",n+"px")}copyToClipboard(n){var t=document.createElement("textarea");document.body.appendChild(t);t.value=n;t.select();document.execCommand("copy");document.body.removeChild(t)}initFormEvents(){$(this.pageSelector+" .update-product").one("click",n=>{var t=$(n.currentTarget).attr("data-next");this.updateProduct(t);$(this.pageSelector+" .update-product").hide()});$(this.pageSelector+" .price-draft-button").on("click",()=>{$(this.pageSelector+" .c-price-draft-info-over-price").hide(),$(this.pageSelector+" .price-draft-button").hide(),$(this.pageSelector+" .c-price-draft-after-agreed").show()});$(this.pageSelector+" textarea").one("change",()=>{$(this.pageSelector+" .update-product").show()});null!=$("#admin-select-order").attr("data-id")?$(this.pageSelector+" .add-to-order[number=0]").show():$(this.pageSelector+" .add-to-order[number=0]").hide();$(this.pageSelector+" .add-to-order").one("click",n=>{var t=Number($(n.currentTarget).attr("number"));this.addToOrder(n,t)});$(this.pageSelector+" .calculate").on("change",n=>{this.checkInputBeforeCalculatePrice($(n.currentTarget))&&(clearTimeout(this.calculatePriceTimer),this.calculatePriceTimer=setTimeout(()=>{this.calculatePrice()},this.calculatePriceDelay))});$(this.pageSelector+" #product-template").on("changed.bs.select",n=>{var i=$(n.currentTarget).val(),r=t.getProductRouteName(this.Product.parentKey);t.navigate(r,{productName:i})});$(this.pageSelector+" .remove-coupon").on("click",n=>{var t=$(n.currentTarget).parent().attr("data-id");console.log("removing coupon",t);abp.services.app.product.removeCouponFromProduct(t).then(()=>{$(n.currentTarget).parent().hide(),$(this.pageSelector+" input[name=itemCount]").prop("readonly",!1),this.calculatePrice(),this.updateProduct(!1)})});$(this.pageSelector).on("click",".create-zip",n=>{n.preventDefault();var t=$(this.pageSelector+" .fileupload").find("input[name=directory]").val();abp.services.app.file.createZip(t).then(()=>{abp.notify.success("zip created");var i=t.split(/[/]+/).pop(),r=window.location.origin+"/Uploads/LocalUser/"+t+"/"+i+".zip",n=document.createElement("a");document.body.appendChild(n);$(n).attr("href",r).attr("download",i);n.click();$(n).unbind();$(n).remove();this.loadFilesFromFolder()})});$(this.pageSelector+" #edit-product-name").on("click",n=>{n.preventDefault(),$(this.pageSelector+" #edit-product-name").hide(),$(this.pageSelector+" .product-name").hide(),$(this.pageSelector+" .new-product-name").css("display","initial")});$(this.pageSelector+" select[name=printDataType]").on("change",n=>{var t=$(n.currentTarget).selectpicker("val");$(this.pageSelector+" .haveData-tab").hide();$(this.pageSelector+" .useGraphic-tab").hide();$(this.pageSelector+" .studio-tab").hide();0==t?$(this.pageSelector+" .haveData-tab").show():1==t?$(this.pageSelector+" .useGraphic-tab").show():2==t&&$(this.pageSelector+" .studio-tab").show()});$(this.pageSelector).on("click",".template-download.json a",n=>{n.preventDefault();var t=$(n.currentTarget).attr("title"),i=(new URL($(n.currentTarget).attr("href")),{directory:"/Uploads/LocalUser/"+$(this.pageSelector+" .fileupload").find("input[name=directory]").val()+"/",templateName:this.Product.productTemplateId,templateId:t});abp.auth.isGranted("Admin.Products.Edit")||null!=abp.currentUser.impersonatorUserId?swal.fire({title:"Vytvoriť PDF?",html:'<a class="link-open-design" href="'+t+'">'+t+"<\/a>",icon:"question",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"PDF",confirmButtonColor:"#52c9ba",denyButtonText:"Editor",denyButtonColor:"#ff4081",cancelButtonText:"Zrušiť"}).then(n=>{n.isConfirmed?abp.services.app.pdf.generatePdf(i).then(()=>{this.loadFilesFromFolder(),swal.fire({icon:"success",title:"PDF vytvorené",toast:!0,position:"bottom-start",showConfirmButton:!1,timer:3e3})}):n.isDenied&&this.createStudio(i)}):abp.message.confirm(t,"Prajete si editovať váš dizajn?").then(n=>{n.isConfirmed&&this.createStudio(i)})});$("body").on("click",".link-open-design",n=>{n.preventDefault();swal.close();var t=$(n.currentTarget).attr("href");new app.ModalManager({viewUrl:abp.appPath+"admin/designs/createoreditmodal",scriptUrl:abp.appPath+"Scripts/app/Designs/_CreateOrEditModal.js",modalClass:"CreateOrEditDesignModal"}).open({id:t})});window.addEventListener("StudioFinished",this.loadFilesFromFolderCallback,!1)}calculatePrice(){$(this.pageSelector+" .update-product").show();this.updateProductData();abp.services.app.price.calculatePrice(this.Product).then(n=>{this.afterCalculatePriceHandler(n),window.location.toString().toLowerCase().indexOf("admin")})}updateProduct(n,t){this.updateProductData();var i=$(this.pageSelector+" #product-formular").attr("data-cart");abp.ui.setBusy(this.pageSelector+" .update-product");abp.services.app.product.updateProduct(this.Product,n,i).then(i=>{this.afterUpdateProductHandler(n,i,t),abp.ui.clearBusy(this.pageSelector+" .update-product")})}addToOrder(n,i=0){var r=null;if(0==i){if(null==(r=$("#admin-select-order").attr("data-id")))return void abp.message.warn("Najprv vyberte objednávku");this.Product.orderId=Number(r)}this.updateProductData();var u=$(this.pageSelector+" #product-formular").attr("data-cart"),f=$(this.pageSelector+" #product-formular").attr("redirect-url"),e=$(this.pageSelector+" #sessionId").val();abp.ui.setBusy(n.currentTarget,abp.services.app.product.updateProduct(this.Product,!1,u,e,i).then(n=>{""==window.location.hash?-2==i?location.href=location.href+"/"+n.id:(Cookies.set("cart-added",n.id,{expires:new Date((new Date).getTime()+3e5)}),location.href=f):(i<0&&abp.services.app.order.getProductCount().then(function(n){var t=null==abp.currentUser.impersonatorUserId?"green":"dark";n.count>0?$("#admin-cart").attr("data-after-content",n.count).addClass("badge-top").addClass(t):$("#admin-cart").attr("data-after-content",0).removeClass("badge-top").addClass(t);n.wishlistCount>0?$("#admin-wishlist").attr("data-after-content",n.wishlistCount).addClass("badge-top purple"):$("#admin-wishlist").attr("data-after-content",0).removeClass("badge-top purple")}),-2==i?t.navigate("wishlist"):-1==i?t.navigate("orderDetail",{}):t.navigate("orderDetail",{id:r}))}))}updateProductData(){var n=$(this.pageSelector+" select[name=materialKey] option:selected").is(":disabled"),t=$(this.pageSelector+" select[name=coverMaterialKey] option:selected").is(":disabled");n&&($(this.pageSelector+" select[name=materialKey] option:selected").prop("disabled",!1),$(this.pageSelector+" select[name=materialKey]").selectpicker("refresh"));t&&($(this.pageSelector+" select[name=coverMaterialKey] option:selected").prop("disabled",!1),$(this.pageSelector+" select[name=coverMaterialKey]").selectpicker("refresh"));$.extend(this.Product,$(this.pageSelector+" #product-formular").serializeFormToObject());this.Product.printDataType=Number($(this.pageSelector+' select[name="printDataType"]').selectpicker("val"));this.Product.printDataLink=$(this.pageSelector+' input[name="printDataLink"]').val();this.Product.printDataInfo=$(this.pageSelector+' textarea[name="printDataInfo"]').val();this.Product.comments=$(this.pageSelector+' textarea[name="comments"]').val();this.Product.extraWork=$(this.pageSelector+' textarea[name="extraWork"]').val();this.Product.productNote=$(this.pageSelector+' textarea[name="productNote"]').val();n&&($(this.pageSelector+" select[name=materialKey] option:selected").prop("disabled",!0),$(this.pageSelector+" select[name=materialKey]").selectpicker("refresh"));t&&($(this.pageSelector+" select[name=coverMaterialKey] option:selected").prop("disabled",!0),$(this.pageSelector+" select[name=coverMaterialKey]").selectpicker("refresh"));abp.auth.isGranted("Admin.Products.Edit")||null!=abp.currentUser.impersonatorUserId?(this.Product.priceExtra=$(this.pageSelector+" input[name=priceExtra]").val(),this.Product.taxPc=$(this.pageSelector+" select[name=taxPc]").val()):(console.log("default tax",Number(abp.setting.get("TaxPc"))),this.Product.taxPc=Number(abp.setting.get("TaxPc")));this.Product.priceExtra=this.Product.priceExtra?this.Product.priceExtra:0}afterUpdateProductHandler(n,i){abp.event.trigger("product-changed",i);abp.notify.success("Produkt aktualizovaný");var r=$(this.pageSelector+" #OrderDetailButton").attr("data-order-id"),u=Number($(this.pageSelector+" #OrderDetailButton").attr("data-order-number")),f=window.location.toString().indexOf("admin")>-1;console.log("navigate: ",u,r,this.Product.stateEnum);f?-2==u?t.navigate("wishlist"):-1==u?t.navigate("orderDetail",{}):null!=r?Number(this.Product.stateEnum)<3?t.navigate("orderDetail",{id:r}):window.history.back():$(window).trigger("hashchange"):window.location.reload()}updateGrammage(n=!1){var u=n?"coverGrammageOrThickness":"grammageOrThickness",f=n?"coverEncapsulation":"encapsulationOrBleed",i=Number(abp.setting.get("EncapsulationMaxGrammage")),r=Number($(this.pageSelector+" select[name="+u+"]").selectpicker("val")),t=$(this.pageSelector+" input[name="+f+"]")[0];r<=i&&null!=t&&($(t).removeAttr("disabled"),$(this.pageSelector+" .encapsulation-max-gramage").hide());null!=t&&r>i&&($(this.pageSelector+" .encapsulation-max-gramage").html("Pri enkapsulácii je maximálna možná gramáž papiera "+i+"g."),$(t).attr("disabled",""),$(t).prop("checked",!1),$(this.pageSelector+" .encapsulation-max-gramage").show())}initItemCountBounderies(){this.min=Number($(this.pageSelector+" input[name=itemCount]").attr("min"));this.max=Number($(this.pageSelector+" input[name=itemCount]").attr("max"))}initDimensionRestrictions(){this.minDimensions=JSON.parse($(this.pageSelector+" input[name=minDimensions]").val());this.maxDimensions=JSON.parse($(this.pageSelector+" input[name=maxDimensions]").val());this.stepDimension=JSON.parse($(this.pageSelector+" input[name=stepDimension]").val());console.log("DIM: ",this.minDimensions,this.maxDimensions,this.stepDimension)}initFileUpload(){var n=$(this.pageSelector+" .fileupload"),t=$(this.pageSelector+" .files");0!=n.length&&((n=n.fileupload({disableImageResize:!0,autoUpload:!0,maxFileSize:104857600,filesContainer:t,messages:{maxFileSize:"File exceeds maximum allowed size of 100MB"},acceptFileTypes:/(\.|\/)(gif|jpe?g|png|pdf|doc|docx|xls|xlsx|csv|zip|rar|cdr|psd|tif|tiff|7z|indd|qxd|ai|eps|dxf)$/i})).fileupload("option","redirect",window.location.href.replace(/\/[^\/]*$/,"/cors/result.html?%s")),n.on("fileuploaddestroy",function(n,t){$.ajax({data:JSON.stringify({path:t.url}),dataType:"json",contentType:"application/json",type:"POST",url:abp.appPath+"api/file/deletefile"}).then(function(){t.context[0].remove()})}),this.loadFilesFromFolder())}loadFilesFromFolder(){console.log("called studio event");var n=$(this.pageSelector+" .fileupload");$(this.pageSelector+" tbody.files").empty();n.addClass("fileupload-processing");$.ajax({url:n.attr("action"),type:"POST",contentType:"application/x-www-form-urlencoded",cache:!1,processData:!1,data:n.serialize()}).always(()=>{n.removeClass("fileupload-processing")}).done(t=>{console.log("files",t),n.fileupload("option","done").call(n,$.Event("done"),{result:t})})}initUserEdit(){$(this.pageSelector+" #EditUserButton").on("click",n=>{n.preventDefault();var i=$(n.currentTarget).attr("data-user-id");t.navigate("profile",{id:i})})}initOrderDetail(){$(this.pageSelector+" #OrderDetailButton").on("click",n=>{var i,r;n.preventDefault();i=Number($(n.currentTarget).attr("data-order-number"));-2==i?t.navigate("wishlist"):-1==i?t.navigate("orderDetail",{}):(r=$(n.currentTarget).attr("data-order-id"),t.navigate("orderDetail",{id:r}))})}P$(n){return $(this.pageSelector+" "+n)}canShowDraftPrice(){var n=$(this.pageSelector+" input[name=orderState]").val();return!("True"!=$(this.pageSelector+" input[name=canShowDraftprice]").val()||n>2)}setTitle(){if("True"!=this.Product.isDefault){var n=$(this.pageSelector+" input[name=orderNumber]").val(),t=$(this.pageSelector+" input[name=orderCreatorName]").val(),i=""!=n?"P | "+n+" | "+t:"Nový produkt";super.setTitle(i)}}log(n,t){if(console.log(t),("object"==typeof t||Array.isArray(t))&&null!==t)for(var i in t)0==t[i]&&delete t[i];abp.auth.isGranted("Admin.Products.Edit")&&console.info(n+": ",t)}getGrammageRange(){var t,i=$(this.pageSelector+" .grammage-range").attr("data"),n=null==i||void 0===i?[]:i.split(",").join(".").split(";");return t=2==n.length?[parseFloat(n[0]),parseFloat(n[1])]:4==n.length?[parseFloat(n[0]),parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3])]:[Number.MIN_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MAX_VALUE],console.log(t),t}createStudio(n){var t;$(this.pageSelector+" #open-studio").append(' <i class="fa fa-spinner fa-spin"><\/i>');"function"==typeof smartsupp&&(null===(t=top.document.getElementById("smartsupp-widget-container"))||void 0===t||t.style.setProperty("display","none","important"));window.APP_DATA=n;$.when($.getScript(io.runtime),$.getScript(io.polyfills),$.getScript(io.main),$.Deferred(function(n){$(n.resolve)})).done(()=>{console.log("studio created"),$(this.pageSelector+" #open-studio i").remove()})}}class o extends e{constructor(n){super("AdvertisingSystem",n);this.ActualFormats=new r("LargeDigitalPrint")}onStart(){this.onEnter();this.updateProductData();this.initItemCountBounderies();this.initDimensionRestrictions();super.onStart()}onDestroy(){$(this.pageSelector+" .copy-product").off("click");super.onDestroy()}initFormEvents(){super.initFormEvents();$(this.pageSelector+" .copy-product").on("click",()=>{this.updateProductData();console.log(this.Product);var i=$(this.pageSelector+' select[name="optionId"]').siblings("button.dropdown-toggle").attr("title"),n=abp.localization.localize(this.Product.productTemplateId,"PrintDigital")+"\n\nNáklad: "+this.Product.itemCount+" ks\n: Variant: "+i,t=$(this.pageSelector+" textarea[name=extraWork]").val();n+=null!=t&&""!=t?"\n\nPoznámka Typoconu: "+t:"";n+="\n\nCena: "+$(this.pageSelector+" #price-base").text()+"€\nCena po zľave: "+$(this.pageSelector+" #price-discount").text()+"€\nCena za kus: "+$(this.pageSelector+" #price-item").text()+"€\nSpolu s DPH: "+$(this.pageSelector+" #price-total").text()+"€";super.copyToClipboard(n);console.log("vypis copy",n);abp.notify.info(app.localize("ProductCopiedToClipboard"))})}afterCalculatePriceHandler(n){var i,t,r;this.log("price",n);void 0===n.chromaPrice&&(n.chromaPrice=0);void 0===n.priceBase&&(n.priceBase=0);void 0===n.priceWithTax&&(n.priceWithTax=0);t=n.priceBase-.01*this.Product.discount*n.chromaPrice;t=t<0?0:t;r=0==this.Product.itemCount||0==t?t:t/this.Product.itemCount;this.P$("#price-base").html(NumberFormatter.formatDecimal(n.priceBase,2));this.P$("#price-discount").html(NumberFormatter.formatDecimal(t,2));this.P$("#price-item").html(NumberFormatter.formatDecimal(r,2));this.P$("#price-total").html(NumberFormatter.formatDecimal(n.priceWithTax,2));this.P$("#add-to-basket").prop("disabled",!1);Object.keys(n).forEach(function(t){n[t]});null!==(i=n.weight)&&void 0!==i||(n.weight=0);$(this.pageSelector+" input[name=weight]").val(n.weight);$(this.pageSelector+" input[name=width]").val(n.width);$(this.pageSelector+" input[name=height]").val(n.height)}checkInputBeforeCalculatePrice(n){var r=!0,i=n.attr("name"),t;return null==i&&(r=!1),t=null,"itemCount"===i?t=this.Product.itemCount:"width"===i?t=this.Product.width:"height"===i&&(t=this.Product.height),null!=t&&(isNaN(n.val())||n.val()%1!=0)&&(n.val(t),r=!1),"itemCount"===i&&(n.val()<this.min&&n.val(this.min),n.val()>this.max&&n.val(this.max)),r}}const i=jQuery;i(document).ready(function(){i('[data-toggle="popover"]').popover();i(".tooltips").tooltip();new o("#advertisingSystem-form").onStart()})})();
